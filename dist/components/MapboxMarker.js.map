{"version":3,"file":"MapboxMarker.js","sources":["../../src/components/MapboxMarker.vue"],"sourcesContent":["<template>\n  <div>\n    <div ref=\"content\">\n      <slot />\n    </div>\n    <mapbox-popup\n      v-if=\"popup\"\n      ref=\"popup\"\n      v-bind=\"popupOptions\">\n      <slot name=\"popup\" />\n    </mapbox-popup>\n  </div>\n</template>\n\n<script>\n  import { Marker, Point } from 'mapbox-gl';\n  import { injectMap } from '../mixins/provide-inject-map';\n  import bindProps from '../utils/bind-props';\n  import { bindEvents, unbindEvents } from '../utils/bind-events';\n  import MapboxPopup from './MapboxPopup';\n\n  /**\n   * Component's props definition, we need to declare it outside the component\n   * to be able to test the default values and the types.\n   * @see  https://docs.mapbox.com/mapbox-gl-js/api/#marker\n   * @type {Object}\n   */\n  const props = {\n    lngLat: {\n      type: Array,\n      required: true,\n    },\n    popup: {\n      type: [ Object, Boolean ],\n      default: false,\n      bind: false,\n    },\n    element: {\n      type: HTMLElement,\n      default: null,\n    },\n    offset: {\n      type: [ Point, Array ],\n      default: null,\n    },\n    anchor: {\n      type: String,\n      default: 'center',\n    },\n    color: {\n      type: String,\n      default: null,\n    },\n    scale: {\n      type: Number,\n      default: 1,\n    },\n    draggable: {\n      type: Boolean,\n      default: false,\n    },\n    rotation: {\n      type: Number,\n      default: 0,\n    },\n    pitchAlignment: {\n      type: String,\n      default: 'auto',\n    },\n    rotationAlignment: {\n      type: String,\n      default: 'auto',\n    },\n  };\n\n  /**\n   * All Map events which will be mapped/bounded to the component\n   * @see  https://docs.mapbox.com/mapbox-gl-js/api/#marker.event:dragstart\n   * @type {Array}\n   */\n  const events = [ 'dragstart', 'drag', 'dragend' ];\n\n  export default {\n    name: 'MapboxMarker',\n    components: {\n      MapboxPopup,\n    },\n    mixins: [ injectMap() ],\n    props,\n    computed: {\n      hasPopup() {\n        return this.popup !== false && this.$refs.popup !== undefined;\n      },\n      popupInstance() {\n        return this.hasPopup ? this.$refs.popup.popup : null;\n      },\n      popupOptions() {\n        return {\n          lngLat: this.lngLat,\n          ...this.popup,\n          renderless: true,\n        };\n      },\n      options() {\n        const { lngLat, popup, ...options } = this.$props;\n\n        // Use current component's element if container is not set\n        if (this.$slots.default) {\n          options.element = this.$refs.content;\n        }\n\n        return options;\n      },\n    },\n    mounted() {\n      this.marker = new Marker(this.options)\n        .setLngLat(this.lngLat)\n        .addTo(this.map);\n\n      // Bind props and events\n      bindProps(this, this.marker, props);\n      bindEvents(this, this.marker, events);\n\n      if (this.hasPopup) {\n        this.marker.setPopup(this.popupInstance);\n      }\n    },\n    destroyed() {\n      if (this.marker) {\n        unbindEvents(this, this.marker);\n        this.marker.remove();\n      }\n    },\n  };\n</script>\n"],"names":[],"mappings":";;;;;;;;AAqBA;AACA;AACA;AACA;AACA;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;AAgDA;AACA;AACA;AACA;AACA;;AACA,6CAAA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAAA;;;AAhFA,2BAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}